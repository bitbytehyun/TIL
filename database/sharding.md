# 샤딩이란
## 실제 개념
샤딩이란, 하나의 데이터베이스를 샤드(Shard)단위로 수평분할하는 기법으로, 데이터를 여러 DB 인스턴스에 분산합니다.
주로 데이터 양이 너무 많아서 한 서버에 담기 힘들 때 (-> 수직 확장도 한계가 어디까지 있나??), 트래픽이 너무 커서 한 서버가 처리하기 벅찰 때, 
글로벌 서비스에서 지리적으로 가까운 서버로 데이터 배치가 필요할 때 활용됩니다. 
(-> 캐시를 안하고 이렇게 수평확장을?????? 그래서 nosql이 나온게 아니었나?)
트위터, 페이스북, 카카오톡 같은 초대규모 서비스에 필요합니다. 

**Range Sharding**
* 특정 키 값의 범위에 따라 분산됩니다.
* 단, 특정 구간에 데이터가 몰리는 hotspot이 될 수 있습니다.

**Hash Sharding**
* 샤드 키를 해시 함수로 변환해서 분산합니다. (예: `hash(user_id) % 4`는 4개의 샤드에 균등하게 분배합니다.)
* 단, 샤드 수 변경 시, 데이터 재배치 비용이 커집니다. 


**Directory/Lookup Sharding**
* 별도의 샤드 매핑 테이블을 두어 분산합니다.
* 유연성은 높지만 매핑 관리 비용이 존재합니다.


### 장점
* **무한 확장**: 서버의 수평확장이 무한히 가능합니다.
* **부하 분산**: 요청을 여러 서버로 나누어 처리할 수 있어, 부하가 분산됩니다.
* **장애 격리**: 특정 샤드 장애 시, 전체 장애로 번지지 않습니다.

### 단점
* **운영 복잡성**: 샤드 키 설계, 분산 트랜젝션 처리, 장애 조치 관리가 복잡합니다.
* **조인/집계 어려움**: 데이터가 여러 샤드에 흩어져 있어, cross-shard JOIN이 불가합니다. 어플리케이션 레벨에서만 처리해야합니다.
* **재샤딩 비용**: 샤드 수 변경 시, 데이터 재배치할 때 서비스 중단 위험이 있습니다. 
