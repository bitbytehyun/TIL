# replica 동기화 방법
## 실제 개념

복제란, Master 노드의 데이터를 Replica(Slave) 노드로 동기화하여 여러 노드가 동일한 상태를 유지하도록 하는 기술입니다. 
주요 목적은 읽기 성능 분산, 고가용성 분산, 데이터 백업 등입니다. 
### 복제 동작 흐름
1. Master 노드는 쓰기 트랜젝션(insert, update, delete, alter 등)이 실행된 후, 해당 변경 내용을 binary log에 기록합니다.
1. Replica 노드는 Master에 접속하여 Binary log를 요청하고, Master는 binary log를 스트르밍 방식으로 전달합니다. Replica는 이를 받아서 Relay Log에 저장합니다.
1. Replica는 Relay Log에 저장된 명령을 순서대로 읽고 재실행하여, Master와 동일한 데이터 상태를 유지합니다.
  
### 복제 방식
1. 동기 복제 : Master가 Replica가 변경사항을 모두 적용(3단계 완료)했을 때, 사용자에게 쓰기 완료를 응답합니다.
    * 강한 일관성을 보장하지만, 성능 저하가 심해서 거의 사용하지 않습니다. 
1. 비동기 복제 : Master가 binary log를 기록 후, 즉시 사용자게에 응답하고 Replica는 나중에 따라갑니다.
    * 빠른 응답성을 보이지만, 데이터 일관성이 불완전합니다.  
1. 세미-동기 복제 : 최소 하나의 Replica가 변경 적용 완료 응답을 보내면, Master가 사용자에게 응답합니다.
    * 비동기 복제와 동기 복제의 절충안입니다.
    * 문제 : Replica들의 부분적 데이터 불일치, 마스터 장애 시 데이터 손실 위험, 1개의 Replica 응답을 기다리는 성능 지연 발생 가능성
    * 완화 전략 : 슬레이브 지연 시간을 지속적으로 모니터링, 복제 타임아웃 정책 적용, 중요 트랜젝션은 동기 복제 처리 등 필요

