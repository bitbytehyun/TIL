# Redis란
## 실제 개념
Redis란 인메모리 데이터 저장소이며, key-value 구조로 저장형태를 지원합니다. 
이는 초고속 데이터 접근을 위해 모든 데이터를 RAM에 저장합니다.
단순한 캐시뿐만 아니라, 다양한 데이터 구조, 고가용성, 지속성 옵션을 제공해서 캐시, 메시지 브로커, 실시간 분석 등 광범위하게 활용될 수 있습니다.

### 특징
1. 인메모리 저장:
    * 모든 데이터가 RAM에 저장되어 마이크로초~밀리초 단위로 응답할 수 있습니다.
    * 디스크에 영구 저장도 가능하며, 두가지 방식이 있습니다.
        * AOF(Append Only File): 모든 쓰기 연산을 순차적으로 로그에 기록합니다. 장애 시 로그를 재실행하여 복구하는데, 데이터 유실은 위험은 최소화되지만 복구 속도는 느립니다.
        * RDB(Snapshot): 특정 시점 데이터의 스냅샷을 디스크에 저장하여 복구 속도가 빠릅니다. 하지만 마지막 저장 이후 변경 데이터는 유실될 수 있습니다.
        * 혼합 모드로 설정하면 복구 속도와 안정성을 모두 확보할 수 있습니다.
    * 주의: 메모리 파편화나 메모리 부족 시 응답지연 및 프로세스가 다운될 수 있습니다. 메모리 사용량을 모니터링하고 여유분 확보가 필요합니다.
1. 다양한 데이터 구조 지원: `String`(예: `"user:1:name" -> "서현"`), `List`, `Set`, `SortedSet` (점수 기반 순위 저장에 유용), `Hash`(객체 속성 저장에 유용), `Bitmap` 등을 지원할 수 있습니다.
1. 단일 스레드 이벤트 루프
    * 한 번에 하나의 명령만 처리하여, 락 경쟁이 최소화됩니다.
    * 처리 시간이 긴 명령(예: `KEYS *`, 대량 데이터 정렬 등)은 전체를 블로킹할 수 있으므로 실무에서는 피해야 합니다.
1. 만료(TTL) 기능
    * Key 별로 만료 시간을 설정할 수 있어서, 로그인 토큰, 인증 코드 등을 자동 삭제할 수 있습니다.

### 고가용성
레디스를 여러 서버로 운영하면, 둘 중 하나의 방식 중 하나를 골라서 운영해야 합니다. 
* Sentinel
    * 마스터-슬레이브 복제 구조에서 장애 감지 후 자동 Failover을 수행합니다.
    * 다수의 Sentinel 노드가 마스터 상태를 감시하고, 과반 이상이 장애로 판단하면 슬레이브를 마스터로 승격합니다.
    * 네트워크 분리 상황에서 오동작이 가능하므로, SDOWN, ODOWN 방식을 사용합니다. (???)
* Cluster
    * 데이터의 샤딩 + 복제를 동시에 지원합니다.
    * 여러 마스터-슬레이브 그룹으로 구성되어, 각 마스터는 데이터 일부를 저장합니다.
    * 일부 노드 장애 시에도 나머지 노드가 데이터를 저장합니다.
 

### 활용
| 사용 사례         | 설명                                |
| ------------- | --------------------------------- |
| **캐시(Cache)** | DB 부하 감소, 자주 조회되는 데이터 저장          |
| **세션 관리**     | Spring Session + Redis로 로그인 세션 저장 |
| **실시간 분석**    | 실시간 클릭 수, 접속자 수 집계                |
| **실시간 순위**    | 게임 랭킹, 인기 게시물 Top-N               |
| **메시지 브로커**   | Pub/Sub으로 채팅, 실시간 알림              |
| **분산락**       | 여러 서버에서 동시 접근 제어                  |
| **카운팅**       | 조회수·좋아요 수 등 빠른 집계                 |
