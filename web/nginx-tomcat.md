# nginx, tomcat 이란
## 실제 개념
### Nginx
웹서버 소프트웨어이지만, 단순히 HTML 파일만 서빙하지 않고 다양한 역할을 가지고 성능이 뛰어난 서버입니다. 
아벤트 기반 비동기 처리 모델을 갖고 있어, 고성능, 고병렬 처리에 강점을 갖고 있습니다. 

#### 주요 역할
* 정적 컨텐츠 제공
    * HTML, CSS, JS, 이미지 같은 파일을 클라이언트에게 직접 제공합니다.
    * 동적 서버(Spring, Node) 로 넘기지 않아도 되므로 빠르고 효율적입니다.
* 리버스 프록시
    * 클라이언트 요청을 받아서 백엔드 서버로 대신 전달하고 응답도 대신 반환합니다.
    * 외부에는 Nginx만 노출하여 보안(백엔드 서버의 IP 숨기기), 성능, 확장성(로드밸런싱으로 트래픽 분산)을 높일 수 있습니다.
    * 예: `client → Nginx (443/https) → Spring Boot (8080)`
* 로드 밸런싱
    * 여러 어플리케이션 서버에 트래픽을 분산합니다.
    * 지원 방식: 라운드 로빈, 최소 연결, IP 해시 등이 있습니다.
    * 서버 다운 시, 헬스 체크 후 자동으로 제외할 수 있습니다. 
* SSL/TLS 종료
    * nginx가 브라우저와 HTTPS로 통신하고, nginx가 내부 서버에는 HTTP로 전달합니다.
    * HTTPS 암호화 및 복호화를 Nginx에서 처리할 수 있습니다.
    * 백엔드 서버에는 HTTP 평문으로 통신하여, 성능 부담을 분산합니다. 
* 캐싱
    * 자주 쓰이는 응답(예: 이미지, API 결과 등)을 Nginx에 캐싱합니다.
    * API 응답, 정적 파일, 이미지 등을 캐싱하여 백엔드 부하를 감소합니다 .
* 압축
    * 네트워크 트래픽 감소로 응답 속도를 향상할 수 있습니다.
* URL 재작성
    * URL을 재작성하여 SEO, 버전관리, 깔끔한 앤드포인트로 구성할 수 있습니다.
    * 예: `/old` 에서 `/new`/로 리다이렉트
* 보안 강화
    * WAF (Web Application Firewall) 플러그인 가능
    * rate limiting으로 DoS 방어
    * IP 제한
    * CORS, HSTS, CSP 등으로 헤더 보안 설정
* 모니터링, 로그 관리
    * Acccess log, Error log 로 성능/보안 모니터링이 가능합니다.
    * JSON 로그로 포맷하여 ELK, Prometheus와 연동이 가능합니다.
#### 장점
* 이벤트 기반 구조 (비동기, non-blocking I/O)이기 때문에, 가볍고 빠릅니다.
* 수만 개의 연결도 안정적으로 처리하여 동시성 처리가 높습니다.
* 설정파일 `nginx.conf`로 쉽게 관리가 가능하여, 배포와 운영이 단순합니다. 

#### 예시
* 클라이언트 -> 프록시 (Nginx) -> Spring Boot / Tomcat 서버
* 대규모 서비스에서 프론트 라인에 배치되는 서버로 활용됩니다.

### Tomcat
자바로 작성된 웹 어플리케이션을 실행하기 위해 만들어진 서버입니다. 
Java Servlet Container로 웹 어플리케이션 서버(WAS) 역할을 합니다.

#### 주요 역할
* HTTP 서버 기능
    * 클라이언트로부터 HTTP 요청을 직접 받을 수 있습니다.
    * nginx보다 정적 파일 처리 성능은 떨어지기 때문에, 보통 `nginx 앞 + tomcat 뒤` 조합을 사용합니다. 
* JSP/Servlet 실행
    * Tomcat의 핵심은 Servlet 컨테이너로, Servlet은 자바 코드로 작성된 웹 요청 처리 모듈입니다.
    * 브라우저가 /login 요청을 보내면, tomcat이 해당 요청을 서블릿 객체에 전달하여 자바 코드가 응답을 생성할 수 있습니다. 
* 웹 어플리케이션 실행 환경을 제공
    * Spring, Spring Boot 같은 자바 웹 프레임워크도 결국 내부적으로 서블릿 기반으로 동작하기 때문에, tomcat은 이 프레임워크들이 동작할 실행환경을 제공합니다.

#### 구조
1. `Connector`: 클라이언트의 요청을 받아드리는 부분
2. `Container`: 요청을 서블릿에 전달하고, 실행 결과를 응답으로 돌려줌
3. `Servlet`: 개발자가 작성한 자바 코드

#### 예시
* 클라이언트 -> 프록시 (Nginx) -> 웹 어플리케이션 서버 (Tomcat으로 Spring Boot 앱 실행)
* `web.xml` 기반의 전통적인 Java 웹앱을 실행합니다.

| 구분    | Nginx                           | Tomcat                      |
| ----- | ------------------------------- | --------------------------- |
| 성격    | 웹 서버, 리버스 프록시                   | WAS (서블릿 컨테이너)              |
| 언어    | C 기반 (범용)                       | Java 기반                     |
| 역할    | 정적 파일, 로드밸런싱, SSL, 프록시          | 동적 Java 웹 실행                |
| 처리 모델 | 비동기 이벤트 기반                      | 스레드 풀 기반                    |
| 위치    | **앞단(Front)** – 클라이언트 요청을 받아 분산 | **뒷단(Back)** – 애플리케이션 로직 실행 |
| 대체    | Apache HTTPD, HAProxy           | Jetty, Undertow             |


따라서, 실제 서비스에서는 둘을 함께 사용하는 편입니다. 
```css
[ 클라이언트 ] → [ Nginx ] → [ Tomcat(Spring Boot) ]
```
* Nginx: SSL 처리, 정적 파일 제공, 로드밸런싱
* Tomcat: 동적 Java 웹 앱 실행
Spring Boot를 쓰면 내장 Tomcat이 있어서 별도 설치 없이도 실행 가능하지만, 운영 환경에서는 보통 Nginx + 내장 tomcat 조합을 사용합니다. 
